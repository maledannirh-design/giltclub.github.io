<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GILT Club</title>

<style>
body{
margin:0;
font-family: Arial, Helvetica, sans-serif;
background:#F2E8D5;
color:#2E5D3A;
overflow-x:hidden;
}

/* HEADER */
.header{
position:fixed;
top:0;
left:0;
right:0;
height:64px;
background:white;
display:flex;
align-items:center;
padding:0 10px;
box-shadow:0 2px 10px rgba(0,0,0,0.08);
z-index:999;
overflow:hidden;
}

.logo{
height:46px;
flex-shrink:0;
}

.menu{
display:flex;
gap:6px;
flex:1;
overflow-x:auto;
margin-left:8px;
}
.menu::-webkit-scrollbar{display:none;}

.menu a{
font-size:12px;
padding:6px 10px;
background:#F2E8D5;
border-radius:12px;
text-decoration:none;
color:#2E5D3A;
font-weight:600;
white-space:nowrap;
}

/* GENERAL */
section{
padding-top:80px;
display:flex;
align-items:center;
justify-content:center;
text-align:center;
flex-direction:column;
}

.hero{
min-height:220px;
padding:12px 18px 0;
}

/* PRODUCT */
.store{
background:#fff;
padding-bottom:30px;
}

.slider{
display:flex;
flex-direction:row;
overflow-x:auto;
scroll-snap-type:x mandatory;
-webkit-overflow-scrolling:touch;
padding:14px 10px;
gap:0;
overscroll-behavior-x:contain;
}

.slider::-webkit-scrollbar{
display:none;
}

.card{
flex:0 0 48%;
max-width:48%;
margin:0 5px;
padding:14px 10px;
background:#F2E8D5;
border-radius:18px;
scroll-snap-align:center;
box-shadow:0 6px 14px rgba(0,0,0,.12);
}


.card img{
width:220px;
height:220px;
object-fit:contain;
border-radius:16px;
display:block;
margin:auto;
}
  .card{
display:flex;
flex-direction:column;
justify-content:flex-start;
}

.card button{
margin-top:auto;
}

/* ===== PRODUCT TEXT CONTROL ===== */

.pname{
font-weight:700;
font-size:14px;
margin-top:8px;
line-height:1.25em;

display:-webkit-box;
-webkit-line-clamp:2;
-webkit-box-orient:vertical;
overflow:hidden;
text-overflow:ellipsis;
min-height:2.6em;
}

.pdesc{
font-size:12px;
opacity:.75;
margin-top:4px;
line-height:1.25em;

display:-webkit-box;
-webkit-line-clamp:2;
-webkit-box-orient:vertical;
overflow:hidden;
text-overflow:ellipsis;
min-height:2.4em;
}

/* MEMBER */
#memberSlider{
width:100%;
overflow:hidden;
position:relative;
padding:10px 0 20px 0;
}

#memberTrack{
display:flex;
gap:18px;
padding:0 18px;
will-change:transform;
}

.member-card{
flex:0 0 68%;
min-width:68%;
background:transparent;
text-align:center;
}

.member-card img{
width:170px;
height:210px;
object-fit:cover;
border-radius:20px;
}


/* CALENDAR */
.schedule{
background:#F2E8D5;
padding:20px 10px 10px;
}
.calwrap{
position:relative;
width:100%;
}

.cal-shadow-left,
.cal-shadow-right{
position:absolute;
top:0;
bottom:0;
width:38px;
pointer-events:none;
z-index:3;
}

.cal-shadow-left{
left:0;
background:linear-gradient(to right,#F2E8D5 10%,transparent);
}

.cal-shadow-right{
right:0;
background:linear-gradient(to left,#F2E8D5 10%,transparent);
}

.calendar-strip{
display:flex;
overflow-x:auto;
gap:12px;
padding:10px;
scroll-behavior:smooth;
-webkit-overflow-scrolling:touch;
touch-action:pan-x;
overscroll-behavior-x:contain;
}
.calendar-strip::-webkit-scrollbar{display:none;}

.day-box{
flex:0 0 30%;
min-width:30%;
background:white;
border-radius:18px;
padding:12px 10px;
box-shadow:0 10px 18px rgba(0,0,0,.12);
display:flex;
flex-direction:column;
align-items:center;
justify-content:flex-start;
transition:.25s;
cursor:pointer;
transition:transform .15s ease, box-shadow .15s ease;

}

.day-box.selected{
transform:scale(1.06);
box-shadow:0 14px 28px rgba(0,0,0,.22);
}

.day-box.active{
background:linear-gradient(160deg,#2E5D3A,#1e3d26);
color:white;
}
.day-box:active{
transform:scale(.96);
}

.day-box.active{
background:#2E5D3A;
color:white;
}

.day-box.selected{
outline:3px solid #2E5D3A;
transform:scale(1.05);
}

.day-name{font-size:12px;font-weight:bold;}
.day-date{font-size:18px;font-weight:bold;margin-top:4px;}

.join-btn{
background:linear-gradient(135deg,#2E5D3A,#3f8a5a);
color:white;
border:none;
padding:9px 14px;
border-radius:14px;
margin-top:auto;
font-size:12px;
font-weight:700;
letter-spacing:.3px;
cursor:pointer;

/* efek hidup */
box-shadow:0 6px 14px rgba(46,93,58,.35);
transition:all .18s ease;
}

/* saat disentuh */
.join-btn:active{
transform:scale(.92);
box-shadow:0 2px 6px rgba(0,0,0,.35);
}

/* hover (desktop) */
.join-btn:hover{
background:linear-gradient(135deg,#347c51,#4aa76c);
transform:translateY(-2px);
box-shadow:0 10px 18px rgba(46,93,58,.45);
}

/* pulse halus (biar keliatan bisa diklik) */
@keyframes joinPulse{
0%{box-shadow:0 0 0 0 rgba(46,93,58,.45);}
70%{box-shadow:0 0 0 10px rgba(46,93,58,0);}
100%{box-shadow:0 0 0 0 rgba(46,93,58,0);}
}

.day-box.active .join-btn{
animation:joinPulse 2.2s infinite;
}


.navcal{
background:#2E5D3A;
color:white;
border:none;
border-radius:12px;
padding:8px 12px;
font-size:16px;
z-index:5;
touch-action:manipulation;
}

footer{
text-align:center;
padding:22px 10px;
background:#2E5D3A;
color:white;
font-size:12px;
}

  /* FORCE MOBILE LAYOUT */

@media screen and (min-width: 700px){

  body{
    display:flex;
    justify-content:center;
    background:#2c2c2c;
  }

  body > *{
    max-width:430px;
    width:100%;
    background:#F2E8D5;
    box-shadow:0 0 35px rgba(0,0,0,.35);
  }

  .header{
    left:50%;
    transform:translateX(-50%);
    max-width:430px;
  }
}
  html, body{
touch-action:pan-y;
  }
  .slider,
.calendar-strip{
scrollbar-width:none;
overscroll-behavior:contain;
}

html{
overscroll-behavior-y:none;
}

</style>
</head>

<body>

<div id="loginBox" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);justify-content:center;align-items:center;z-index:9999;">
<div style="background:white;padding:25px;border-radius:18px;width:280px;text-align:center">
  <div id="qrBox" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:99999;align-items:center;justify-content:center;flex-direction:column">
  <video id="qrVideo" autoplay playsinline style="width:90%;max-width:340px;border-radius:16px;"></video>
  <br>
  <button onclick="closeQR()" style="padding:10px 18px;border-radius:12px;border:none;background:white">
    Tutup QR Scan
  </button>
  <p style="color:white;margin-top:10px;font-size:13px">
    Arahkan kamera ke QR Member Card
  </p>

</div>

<h3>Member Login</h3>
<input id="loginUser" placeholder="Username" style="width:90%;padding:10px;margin:6px;border-radius:8px;border:1px solid #ccc">
<input id="loginPin" type="password" placeholder="PIN" style="width:90%;padding:10px;margin:6px;border-radius:8px;border:1px solid #ccc">
<br><br>
<button onclick="doLogin()" style="background:#2E5D3A;color:white;padding:10px 18px;border:none;border-radius:10px">Login</button>
<br><br>
<a href="#" onclick="closeLogin()">Tutup</a>
<p id="loginMsg" style="color:red"></p>
</div>
</div>

<div class="header">
<img src="images/club_product/logo_giltclub.png" class="logo">
<div class="menu">
<a href="#">Daftar</a>
<a href="#" onclick="openLogin()">Login Member</a>
<a href="#">VIP Login</a>
<a href="#" onclick="openQR()">Scan QR</a>
</div>
</div>

<section class="hero">
<h1>WELCOME TO GILT CLUB</h1>
<p>Tennis Sport & Social Community</p>
</section>

<section class="schedule">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;padding:0 8px;">
<button onclick="prevWeek()" class="navcal">‚óÄ</button>
<div style="font-weight:700">Jadwal Main</div>
<button onclick="nextWeek()" class="navcal">‚ñ∂</button>
</div>
<div class="calwrap">
<div class="cal-shadow-left"></div>
<div class="cal-shadow-right"></div>
<div id="calendarStrip" class="calendar-strip"></div>
</div>

</section>

<section class="store">
<h2>Product on Sale (Diskon Gede)</h2>
<div class="slider" id="productSlider"></div>
</section>

<section class="member">
<h2>Meet Our Member</h2>
<div id="memberSlider">
   <div id="memberTrack"></div>
</div>

</section>

<footer>
¬© 2026 GILT Club Tennis Community ‚Äî Balikpapan
</footer>

<script>
const API="https://script.google.com/macros/s/AKfycbzknKXIV6M42SqVVuX2BRdUTlZIvxOXQQKprDxUm71Ev-bx5dQ-GypYAcPhAcziFKuYAg/exec";

/* AUTO SCROLL */
function autoScroll(el,speed=0.4){
let stop=false;
function loop(){
if(stop)return;
el.scrollLeft+=speed;
if(el.scrollLeft+el.clientWidth>=el.scrollWidth-1)el.scrollLeft=0;
requestAnimationFrame(loop);
}
loop();
el.addEventListener("touchstart",()=>stop=true,{passive:true});
el.addEventListener("touchend",()=>setTimeout(()=>{stop=false;loop();},1200),{passive:true});
}

/* PRODUCTS */
async function loadProducts(){
const res=await fetch(API+"?action=products");
const data=await res.json();
const slider=document.getElementById("productSlider");
slider.innerHTML="";
data.forEach(p=>{
const foto="images/club_product/"+p.id+".jpg";
const qty=Number(p.qty);
let status=qty<=0?"<div style='color:red'>Habis</div>":qty<=3?`<div style='color:orange'>Sisa ${qty}</div>`:"<div style='color:green'>Tersedia</div>";
let harga=Number(p.disc)>0?
`<div style="text-decoration:line-through">Rp ${p.price}</div>
<div style="color:red;font-weight:bold">Rp ${p.dprice}</div>
<div style="background:#2E5D3A;color:white;border-radius:8px;padding:3px 8px;display:inline-block">-${p.disc}%</div>`
:`<div style="font-weight:bold">Rp ${p.price}</div>`;
slider.innerHTML+=`
<div class="card">
<img src="${foto}?v=5" onerror="this.src='images/members/default.jpg'">
<div class="pname">${p.name}</div>
<div class="pdesc">${p.desc}</div>
${harga}
${status}
<br>
<button onclick="beliProduk('${p.id}')" style="background:#2E5D3A;color:white;border:none;padding:8px 14px;border-radius:10px;margin-top:8px">Beli</button>
</div>`;
});
autoScroll(slider,0.45);
}
/* ================= MEMBERS ================= */

let memberPos = 0;
let memberSpeed = 0.35;
let memberRAF;

async function loadMembers(){

  const res = await fetch(API+"?action=members");
  const members = await res.json();

  const track = document.getElementById("memberTrack");
  track.innerHTML="";

  members.forEach(m=>{
    track.innerHTML += `
      <div class="member-card">
        <img src="images/members/${m.username.toLowerCase().trim()}.jpg?v=16"
        onerror="this.src='images/members/default.jpg'">
        <h3>${m.name}</h3>
        <p>${m.bio}</p>
      </div>`;
  });

  // DUPLICATE for infinite loop
  track.innerHTML += track.innerHTML;

  startMemberAutoSlide();
}

function startMemberAutoSlide(){

  const track=document.getElementById("memberTrack");

  let isDown=false;
  let startX;
  let moveX;

  track.addEventListener("touchstart",(e)=>{
    cancelAnimationFrame(memberRAF);
    isDown=true;
    startX=e.touches[0].clientX;
  },{passive:true});

  track.addEventListener("touchmove",(e)=>{
    if(!isDown)return;
    moveX=e.touches[0].clientX;
    memberPos += (startX-moveX)*0.6;
    track.style.transform=`translateX(-${memberPos}px)`;
    startX=moveX;
  },{passive:true});

  track.addEventListener("touchend",()=>{
    isDown=false;
    animate();
  });

  function animate(){

    memberPos+=memberSpeed;

    if(memberPos>=track.scrollWidth/2){
      memberPos=0;
    }

    track.style.transform=`translateX(-${memberPos}px)`;
    memberRAF=requestAnimationFrame(animate);
  }

  animate();
}

   
/* LOGIN */
function openLogin(){loginBox.style.display="flex";}
function closeLogin(){loginBox.style.display="none";}
async function doLogin(){
const u=encodeURIComponent(loginUser.value.trim());
const p=encodeURIComponent(loginPin.value.trim());
try{
const r=await fetch(API+`?action=login&username=${u}&pin=${p}`);
const d=await r.json();
if(d.status==="ok"){localStorage.setItem("giltUser",decodeURIComponent(u));closeLogin();alert("Login berhasil!");}
else loginMsg.innerText="Username / PIN salah";
}catch{loginMsg.innerText="Server sibuk";}
}

/* SCHEDULE */
let scheduleData={},offsetDays=0,selectedDate=null;
async function loadSchedule(){
const r=await fetch(API+"?action=schedule");
const arr=await r.json();
scheduleData={};arr.forEach(e=>scheduleData[e.date]=e);
renderCalendar();
}
function todayJakarta(){return new Date(new Date().toLocaleString("en-US",{timeZone:"Asia/Jakarta"}));}

function renderCalendar(){
const strip=document.getElementById("calendarStrip");
strip.innerHTML="";
const today=todayJakarta();
for(let i=-3;i<=3;i++){
const d=new Date(today);
d.setDate(today.getDate()+i+offsetDays);
const key=d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,"0")+"-"+String(d.getDate()).padStart(2,"0");
const box=document.createElement("div");
box.className="day-box";
let html=`<div class="day-name">${d.toLocaleDateString("id-ID",{weekday:"long"})}</div><div class="day-date">${d.getDate()}</div>`;
if(scheduleData[key]){
const ev=scheduleData[key];
html+=`<div style="font-size:11px">${ev.title}</div>
<div style="font-size:11px;font-weight:700">${ev.time}</div>
<div style="font-size:11px">üìç ${ev.court}</div>

<div style="font-size:11px;margin-top:2px">${ev.title}</div>
<div style="font-size:11px">${ev.player}</div>

<div style="font-size:11px;margin-top:4px">Public: Rp${ev.public.toLocaleString()}</div>
<div style="font-size:12px;font-weight:bold">Member: Rp${ev.member.toLocaleString()}</div>


<button class="join-btn" onclick="joinSchedule('${key}')">JOIN</button>`;
box.classList.add("active");
}
box.innerHTML=html;
box.onclick=()=>{
selectedDate=key;
document.querySelectorAll(".day-box").forEach(b=>b.classList.remove("selected"));
box.classList.add("selected");
};
strip.appendChild(box);
}
setTimeout(()=>{const b=document.querySelectorAll(".day-box");if(b[3])b[3].scrollIntoView({inline:"center"});},80);
}
function nextWeek(){offsetDays+=7;renderCalendar();}
function prevWeek(){offsetDays-=7;renderCalendar();}
function joinSchedule(d){
if(!localStorage.getItem("giltUser")){alert("Login member dulu");openLogin();return;}
alert("Reservasi akan terhubung ke sistem booking");
}
let qrScanner;

function openQR(){

  const box=document.getElementById("qrBox");
  box.style.display="flex";

  qrScanner = new Html5Qrcode("qrVideo");

  qrScanner.start(
    { facingMode: "environment" },
    { fps:10, qrbox:250 },
    onScanSuccess
  );
}

function closeQR(){
  document.getElementById("qrBox").style.display="none";
  if(qrScanner) qrScanner.stop();
}
async function onScanSuccess(decodedText){

  closeQR();

  try{

    const res = await fetch(API+`?action=loginqr&member_id=${decodedText}`);
    const data = await res.json();

    if(data.status==="ok"){
      localStorage.setItem("giltUser",data.username);
      alert("Selamat datang "+data.name);
    }else{
      alert("Member tidak ditemukan");
    }

  }catch(e){
    alert("Gagal koneksi server");
  }
}

/* INIT */
window.addEventListener("DOMContentLoaded",()=>{
loadMembers();
loadProducts();
loadSchedule();
});
</script>
<script src="https://unpkg.com/html5-qrcode"></script>
</body>
</html>
